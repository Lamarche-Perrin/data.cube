<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="" />
<meta property="og:type" content="book" />








<meta name="description" content="">

<title></title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="introduction.html#introduction">Introduction</a><ul>
<li><a href="installation.html#installation">Installation</a></li>
<li><a href="authors-and-license.html#authors-and-license">Authors and License</a></li>
</ul></li>
<li class="has-sub"><a href="1-getting-started.html#getting-started"><span class="toc-section-number">1</span> Getting Started</a><ul>
<li><a href="1-1-downloading-the-dataset.html#downloading-the-dataset"><span class="toc-section-number">1.1</span> Downloading the dataset</a></li>
<li><a href="1-2-loading-the-library.html#loading-the-library"><span class="toc-section-number">1.2</span> Loading the library</a></li>
<li><a href="1-3-building-the-cube-with-as-data-cube.html#building-the-cube-with-as.data.cube"><span class="toc-section-number">1.3</span> Building the cube with <code>as.data.cube</code></a></li>
<li><a href="1-4-whats-in-the-cube-with-summary.html#whats-in-the-cube-with-summary"><span class="toc-section-number">1.4</span> What’s in the cube with <code>summary</code></a></li>
<li><a href="1-5-back-to-frame-with-as-data-frame.html#back-to-frame-with-as.data.frame"><span class="toc-section-number">1.5</span> Back to frame with <code>as.data.frame</code></a></li>
</ul></li>
<li class="has-sub"><a href="2-unidimensional-exploration.html#unidimensional-exploration"><span class="toc-section-number">2</span> Unidimensional Exploration</a><ul>
<li><a href="2-1-selecting-one-dimension-with-select-dim.html#selecting-one-dimension-with-select.dim"><span class="toc-section-number">2.1</span> Selecting one dimension with <code>select.dim</code></a></li>
<li><a href="2-2-arranging-elements-with-arrange-elm.html#arranging-elements-with-arrange.elm"><span class="toc-section-number">2.2</span> Arranging elements with <code>arrange.elm</code></a></li>
<li><a href="2-3-plotting-variables-with-plot-var.html#plotting-variables-with-plot.var"><span class="toc-section-number">2.3</span> Plotting variables with <code>plot.var</code></a></li>
<li><a href="2-4-filtering-elements-with-filter-elm-and-top-n-elm.html#filtering-elements-with-filter.elm-and-top_n.elm"><span class="toc-section-number">2.4</span> Filtering elements with <code>filter.elm</code> and <code>top_n.elm</code></a></li>
<li><a href="2-5-other-examples-of-use.html#other-examples-of-use"><span class="toc-section-number">2.5</span> Other examples of use</a></li>
</ul></li>
<li class="has-sub"><a href="3-multidimensional-exploration.html#multidimensional-exploration"><span class="toc-section-number">3</span> Multidimensional Exploration</a><ul>
<li><a href="3-1-selecting-two-dimensions-with-select-dim.html#selecting-two-dimensions-with-select.dim"><span class="toc-section-number">3.1</span> Selecting two dimensions with <code>select.dim</code></a></li>
<li><a href="3-2-plotting-bidimensional-variables-with-argument-sep-dim-names-of-plot-var.html#plotting-bidimensional-variables-with-argument-sep.dim.names-of-plot.var"><span class="toc-section-number">3.2</span> Plotting bidimensional variables with argument <code>sep.dim.names</code> of <code>plot.var</code></a></li>
<li><a href="3-3-plotting-multidimensional-variables.html#plotting-multidimensional-variables"><span class="toc-section-number">3.3</span> Plotting multidimensional variables</a></li>
</ul></li>
<li class="has-sub"><a href="4-outlier-analysis.html#outlier-analysis"><span class="toc-section-number">4</span> Outlier Analysis</a><ul>
<li class="has-sub"><a href="4-1-first-example-bidimensional-outliers.html#first-example-bidimensional-outliers"><span class="toc-section-number">4.1</span> First example: Bidimensional outliers</a><ul>
<li><a href="4-1-first-example-bidimensional-outliers.html#taking-into-account-the-expected-number-of-articles-for-each-country"><span class="toc-section-number">4.1.1</span> Taking into account the expected number of articles for each country</a></li>
<li><a href="4-1-first-example-bidimensional-outliers.html#also-taking-into-account-the-expected-number-of-articles-for-each-week"><span class="toc-section-number">4.1.2</span> Also taking into account the expected number of articles for each week</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="first-example-bidimensional-outliers" class="section level2">
<h2><span class="header-section-number">4.1</span> First example: Bidimensional outliers</h2>
<p>This first example focuses on the evolution over year 2014 of the number of articles citing the 5 following countries: The United States, Russia, Spain, Italy, and Japan.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> &lt;-
<span class="st">    </span>geomedia <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select.dim</span> (week, country) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (week, <span class="kw">format</span> (name, <span class="st">&quot;%Y&quot;</span>) <span class="op">==</span><span class="st"> &quot;2014&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange.elm</span> (week, name)

selected_countries &lt;-<span class="st"> </span><span class="kw">c</span> (<span class="st">&quot;USA&quot;</span>, <span class="st">&quot;RUS&quot;</span>, <span class="st">&quot;ESP&quot;</span>, <span class="st">&quot;ITA&quot;</span>, <span class="st">&quot;JPN&quot;</span>)

geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div id="taking-into-account-the-expected-number-of-articles-for-each-country" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Taking into account the expected number of articles for each country</h3>
<p>By plotting the distribution of all these observations, one could define some king of “statistically expected” range of values and then identify outliers as unexpectedly high (or unexpectedly low) values. In the plot below, one could for example grossly characterise the distribution as a Gaussian curve (values on the left) plus some positive outliers (values on the right).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span> () <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span> (<span class="kw">aes</span> (<span class="dt">x =</span> articles)) <span class="op">+</span><span class="st">    </span>
<span class="st">    </span><span class="kw">geom_histogram</span> (<span class="kw">aes</span> (<span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="dv">30</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span> (<span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Yet, it seems that several Gaussian distributions are actually superimposed. One could hence recognise that each of the five selected country has its own expected range of values, depending on its usual “media coverage” (expected number of articles per week). In this sense, one could hence search for outliers within each of these five distributions independently.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span> () <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span> (<span class="kw">aes</span> (<span class="dt">x =</span> articles, <span class="dt">color =</span> country, <span class="dt">fill =</span> country)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span> (<span class="kw">aes</span> (<span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="dv">30</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span> (<span class="dt">alpha =</span> <span class="fl">0.2</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>To take into account these different ranges of values, another solution consists in normalising the observations by taking into account the expected “media coverage” of each country. Function <code>compute.var.model</code> aims at computing such normalisation models.</p>
<p>This function take in argument a formula specifying the normalisation scheme that needs to be applied. In the example below, formula <code>articles (week * country) ~ articles (country)</code> indicates that we want to model variable <code>articles</code> associated to dimensions <code>week</code> and <code>country</code> (left-hand side) by taking into account its marginal total along dimension <code>country</code> (right-hand side). In other words, with this first model, the number of articles citing a given country during a given week is expected to be similar to <em>the average number of articles citing that country each week</em> (total number in the corpus divided by number of weeks).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country) <span class="op">~</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summary</span> ()</code></pre></div>
<pre><code>## Computing model: articles (week * country) ~ articles (country) * NULL (week)</code></pre>
<pre><code>## data.cube of 2 dimensions and 3 variables
## 
## -&gt; Dimension week
##  - Element number: 52
##  - Class (type):   Date (double)
##  - Element names:  2014-05-19, 2014-10-13, 2014-06-09, 2014-05-26, 2014-06-16, ...
## 
## -&gt; Dimension country
##  - Element number: 5
##  - Class (type):   character (character)
##  - Element names:  USA, ESP, JPN, RUS, ITA
## 
## -&gt; Variable articles
##  - Dimensions:   week x country
##  - Class (type): numeric (double)
##  - NA value:     num 0
## 
## -&gt; Variable articles.model
##  - Dimensions:   week x country
##  - Class (type): numeric (double)
##  - NA value:     num NA
## 
## -&gt; Variable articles.deviation
##  - Dimensions:   week x country
##  - Class (type): numeric (double)
##  - NA value:     num 1</code></pre>
<p>Applying the input formula, function <code>compute.var.model</code> computed two new variables:</p>
<ul>
<li><p>Variable <code>articles.model</code> is the aforementioned average number of articles for each country;</p></li>
<li><p>Variable <code>articles.deviation</code> provides a measure of deviation between the observed variable <code>article</code> and the model. By default, it simply is the ratio between the two variables. For example, <code>articles.deviation == 3</code> indicates that a given country has been three times more cited during a given week than usually. <code>articles.deviation == 0.5</code> indicates that it has been two times less cited.</p></li>
</ul>
<p>These computed variables can now be visualised. Let’s first have a look at the model by plotting <code>articles.model</code>: It simply consists in the total number of articles, averaged among weeks, for each of the five countries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country) <span class="op">~</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.model, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model: articles (week * country) ~ articles (country) * NULL (week)</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_hline).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>We clearly see in the plot above that each of the five countries has a specific expected “media coverage” to which observations can be compared. To do so, we now plot variable <code>articles.deviation</code> that indicates the ratio between observed and expected values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country) <span class="op">~</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.deviation, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model: articles (week * country) ~ articles (country) * NULL (week)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>This plot finally allows for the identification of outliers with respect to each country, relatively to its usual “media coverage”. Values are centered on 1, above are positive outliers, below are negative outliers.</p>
</div>
<div id="also-taking-into-account-the-expected-number-of-articles-for-each-week" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Also taking into account the expected number of articles for each week</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select.dim</span> (week) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country) <span class="op">~</span><span class="st"> </span><span class="kw">articles</span> (week) <span class="op">*</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.deviation, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model: articles (week * country) ~ articles (week) * articles (country)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Note that function <code>filter.elm</code> is applied after function <code>compute.var.model</code>.</p>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="4-outlier-analysis.html"><button class="btn btn-default">Previous</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
