<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multidimensional-exploration.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#a-tutorial-for-the-data.cube-library">A Tutorial for the <code>data.cube</code> Library</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-and-license"><i class="fa fa-check"></i>Authors and License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started.html"><a href="getting-started.html#downloading-the-dataset"><i class="fa fa-check"></i><b>1.1</b> Downloading the dataset</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started.html"><a href="getting-started.html#loading-the-library"><i class="fa fa-check"></i><b>1.2</b> Loading the library</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started.html"><a href="getting-started.html#building-the-cube-with-as.data.cube"><i class="fa fa-check"></i><b>1.3</b> Building the cube with <code>as.data.cube</code></a></li>
<li class="chapter" data-level="1.4" data-path="getting-started.html"><a href="getting-started.html#whats-in-the-cube-with-summary"><i class="fa fa-check"></i><b>1.4</b> What’s in the cube with <code>summary</code></a></li>
<li class="chapter" data-level="1.5" data-path="getting-started.html"><a href="getting-started.html#back-to-frame-with-as.data.frame"><i class="fa fa-check"></i><b>1.5</b> Back to frame with <code>as.data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html"><i class="fa fa-check"></i><b>2</b> Unidimensional Exploration</a><ul>
<li class="chapter" data-level="2.1" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html#selecting-one-dimension-with-select.dim"><i class="fa fa-check"></i><b>2.1</b> Selecting one dimension with <code>select.dim</code></a></li>
<li class="chapter" data-level="2.2" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html#arranging-elements-with-arrange.elm"><i class="fa fa-check"></i><b>2.2</b> Arranging elements with <code>arrange.elm</code></a></li>
<li class="chapter" data-level="2.3" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html#plotting-variables-with-plot.var"><i class="fa fa-check"></i><b>2.3</b> Plotting variables with <code>plot.var</code></a></li>
<li class="chapter" data-level="2.4" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html#filtering-elements-with-filter.elm-and-top_n.elm"><i class="fa fa-check"></i><b>2.4</b> Filtering elements with <code>filter.elm</code> and <code>top_n.elm</code></a></li>
<li class="chapter" data-level="2.5" data-path="unidimensional-exploration.html"><a href="unidimensional-exploration.html#other-examples-of-use"><i class="fa fa-check"></i><b>2.5</b> Other examples of use</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multidimensional-exploration.html"><a href="multidimensional-exploration.html"><i class="fa fa-check"></i><b>3</b> Multidimensional Exploration</a><ul>
<li class="chapter" data-level="3.1" data-path="multidimensional-exploration.html"><a href="multidimensional-exploration.html#selecting-two-dimensions-with-select.dim"><i class="fa fa-check"></i><b>3.1</b> Selecting two dimensions with <code>select.dim</code></a></li>
<li class="chapter" data-level="3.2" data-path="multidimensional-exploration.html"><a href="multidimensional-exploration.html#plotting-bidimensional-variables-with-argument-sep.dim.names-of-plot.var"><i class="fa fa-check"></i><b>3.2</b> Plotting bidimensional variables with argument <code>sep.dim.names</code> of <code>plot.var</code></a></li>
<li class="chapter" data-level="3.3" data-path="multidimensional-exploration.html"><a href="multidimensional-exploration.html#plotting-multidimensional-variables"><i class="fa fa-check"></i><b>3.3</b> Plotting multidimensional variables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="outlier-analysis.html"><a href="outlier-analysis.html"><i class="fa fa-check"></i><b>4</b> Outlier Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="outlier-analysis.html"><a href="outlier-analysis.html#first-example-bidimensional-outliers"><i class="fa fa-check"></i><b>4.1</b> First example: Bidimensional outliers</a><ul>
<li class="chapter" data-level="4.1.1" data-path="outlier-analysis.html"><a href="outlier-analysis.html#taking-into-account-the-expected-number-of-articles-for-each-country"><i class="fa fa-check"></i><b>4.1.1</b> Taking into account the expected number of articles for each country</a></li>
<li class="chapter" data-level="4.1.2" data-path="outlier-analysis.html"><a href="outlier-analysis.html#also-taking-into-account-the-expected-number-of-articles-for-each-week"><i class="fa fa-check"></i><b>4.1.2</b> Also taking into account the expected number of articles for each week</a></li>
<li class="chapter" data-level="4.1.3" data-path="outlier-analysis.html"><a href="outlier-analysis.html#significativity-of-deviations"><i class="fa fa-check"></i><b>4.1.3</b> Significativity of deviations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="outlier-analysis.html"><a href="outlier-analysis.html#plotting-outliers"><i class="fa fa-check"></i><b>4.2</b> Plotting Outliers</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="outlier-analysis" class="section level1">
<h1><span class="header-section-number">4</span> Outlier Analysis</h1>
<p>One of the tools that the <code>data.cube</code> library offers deals with the detection of statistical outliers in multidimensional data. In this context, variables are interpreted as multidimensional <a href="https://en.wikipedia.org/wiki/Contingency_table">contingency tables</a> from which multiple marginal counts can be extracted (depending on the selected dimensions). These marginals then allow for the design of multiple models of the observed variables, from which significant deviations are then interpreted as outliers. In this part of the tutorial, we show how functions <code>compute.var.model</code>, <code>compute.var.deviation</code>, <code>compute.var.outlier</code>, and <code>plot.var.outlier</code> allow for the computation of such models and the visualisation of the resulting deviations.</p>
<p>For more details regarding the formal ground of these functions, please refer to: <em>Audrey Wilmet and Robin Lamarche-Perrin. (2019). Multidimensional Outlier Detection in Temporal Interaction Networks.</em> <a href="https://arxiv.org/abs/1906.02541">arXiv:1906.02541</a></p>
<div id="first-example-bidimensional-outliers" class="section level2">
<h2><span class="header-section-number">4.1</span> First example: Bidimensional outliers</h2>
<p>This first example focuses on the evolution over year 2014 of the number of articles citing the 5 following countries: The United States, Russia, China, Syria, and Japan.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> &lt;-
<span class="st">    </span>geomedia <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select.dim</span> (week, country) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (week, <span class="kw">format</span> (name, <span class="st">&quot;%Y&quot;</span>) <span class="op">==</span><span class="st"> &quot;2014&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange.elm</span> (week, name)

selected_countries &lt;-<span class="st"> </span><span class="kw">c</span> (<span class="st">&quot;USA&quot;</span>, <span class="st">&quot;RUS&quot;</span>, <span class="st">&quot;CHN&quot;</span>, <span class="st">&quot;SYR&quot;</span>, <span class="st">&quot;JPN&quot;</span>)

geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div id="taking-into-account-the-expected-number-of-articles-for-each-country" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Taking into account the expected number of articles for each country</h3>
<p>By plotting the distribution of all these observations, one could define some king of “statistically expected” range of values and then identify outliers as unexpectedly high (or unexpectedly low) values. In the plot below, one could for example grossly characterise the distribution as a Gaussian curve (values on the left) plus some positive outliers (values on the right).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span> () <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span> (<span class="kw">aes</span> (<span class="dt">x =</span> articles)) <span class="op">+</span><span class="st">    </span>
<span class="st">    </span><span class="kw">geom_histogram</span> (<span class="kw">aes</span> (<span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="dv">30</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span> (<span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Yet, it seems that several Gaussian distributions are actually superimposed. One could hence recognise that each of the five selected country has its own expected range of values, depending on its usual “media coverage” (expected number of articles per week). In this sense, one could hence search for outliers within each of these five distributions independently.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span> () <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span> (<span class="kw">aes</span> (<span class="dt">x =</span> articles, <span class="dt">color =</span> country, <span class="dt">fill =</span> country)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_histogram</span> (<span class="kw">aes</span> (<span class="dt">y =</span> ..density..), <span class="dt">binwidth =</span> <span class="dv">30</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span> (<span class="dt">alpha =</span> <span class="fl">0.2</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<div id="compute-model-with-compute.var.model" class="section level4">
<h4><span class="header-section-number">4.1.1.1</span> Compute model with <code>compute.var.model</code></h4>
<p>To take into account these different ranges of values, another solution consists in normalising the observations by taking into account the expected “media coverage” of each country. Function <code>compute.var.model</code> aims at computing such normalisation models.</p>
<p>This function take in argument two formulas specifying the normalisation scheme that needs to be applied. In the example below, first formula <code>articles (week * country)</code> indicates that we want to model variable <code>articles</code> associated to dimensions <code>week</code> and <code>country</code> and second formula <code>articles (country)</code> indicates that the model in question should take into account the marginal total of this variable along dimension <code>country</code>. In other words, with this first model, the number of articles citing a given country during a given week is expected to be similar to <em>the average number of articles citing that country each week</em>, that is <em>the total number of articles citing that country</em> divided by <em>the number of weeks</em>.</p>
<p>Formally, given <span class="math inline">\(w \in \texttt{week}\)</span> and <span class="math inline">\(c \in \texttt{country}\)</span>, we have <span class="math display">\[\texttt{articles.model}(w,c) \quad = \quad \frac{\texttt{articles}(.,c)}{|\texttt{week}|} \text{,}\]</span> where <span class="math inline">\(\texttt{articles}(.,c)\)</span> denotes the marginal total along dimension <code>country</code>: <span class="math display">\[\texttt{articles}(.,c) \quad = \quad \sum_{w&#39; \in \texttt{week}} {\texttt{articles}(w&#39;,c)} \text{.}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country), <span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summary</span> ()</code></pre></div>
<pre><code>## Computing model &#39;articles (week * country) ~ articles (country) * NULL (week)&#39;</code></pre>
<pre><code>## data.cube of 2 dimensions and 2 variables
## 
## -&gt; Dimension week
##  - Element number: 52
##  - Class (type):   Date (double)
##  - Element names:  2014-05-19, 2014-10-13, 2014-06-09, 2014-05-26, 2014-06-16, ...
## 
## -&gt; Dimension country
##  - Element number: 5
##  - Class (type):   character (character)
##  - Element names:  USA, CHN, JPN, SYR, RUS
## 
## -&gt; Variable articles
##  - Dimensions:   week x country
##  - Class (type): numeric (double)
##  - NA value:     num 0
## 
## -&gt; Variable articles.model
##  - Dimensions:   week x country
##  - Class (type): numeric (double)
##  - NA value:     num 0</code></pre>
<p>We see that <code>compute.var.model</code> computed a new variable that has been added to the <code>data.cube</code>: Variable <code>articles.model</code>, that is the average number of articles per week for each country (see above). Let’s now visualise it with <code>plot.var</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country), <span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.model, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model &#39;articles (week * country) ~ articles (country) * NULL (week)&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>This plot simply consists in the average number of articles per week for each of the five countries. We clearly see here that they all have a different expected value to which observations can then be compared.</p>
</div>
<div id="compute-deviation-with-compute.var.deviation" class="section level4">
<h4><span class="header-section-number">4.1.1.2</span> Compute deviation with <code>compute.var.deviation</code></h4>
<p>Function <code>compute.var.deviation</code> provides a measure of deviation between the observed variable <code>article</code> and the computed variable <code>articles.model</code>. It hence compute a third variable <code>articles.deviation</code> which is, by default, the ratio between the two variables, that is the ratio between observed and expected values (see below for other deviation measures).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country), <span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.deviation</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.deviation, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model &#39;articles (week * country) ~ articles (country) * NULL (week)&#39;</code></pre>
<pre><code>## Computing deviation of &#39;articles (week * country)&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Hence, in the plot above, <code>articles.deviation == 3</code> indicates that a country has been three times more cited during a week than usually, and <code>articles.deviation == 0.5</code> indicates that it has been two times less cited.</p>
<p>This plot finally allows for the identification of outliers for each country through time, relatively to their usual “media coverage”. Values are centered on 1. Above this line are <em>positive</em> outliers (more cited than usual) and below are <em>negative</em> outliers (less cited than usual).</p>
</div>
</div>
<div id="also-taking-into-account-the-expected-number-of-articles-for-each-week" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Also taking into account the expected number of articles for each week</h3>
<p>We just saw that the average number of articles is not comparable from one country to another. Similarly, one could point out that the total number of articles is not constant over time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select.dim</span> (week) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>In particular, as we see in the plot above, the dataset we explore contains much less articles during the first weeks of 2014 than later during the year. (This is due to data collection issues.) As a result, it is less likely to observe outliers during that period from the simple fact that observations are almost always below the computed averages. Conversely, outliers that are identified at the end of the year are slightly overestimated as global activity is higher than average at that time.</p>
<p>To compensate for these temporal variations, one can also include them in the computed model. In the plot below, model formula <code>articles (country) * articles (week)</code> indicates that marginal totals are taken into account both for dimension <code>country</code> (as above) and for dimension <code>week</code>. The number of articles citing a given country during a given week is hence expected to be similar to <em>the total number of articles citing that country</em> multiplied by <em>the total number of articles published during that week</em> divided by <em>the total number of articles in the corpus</em>.</p>
<p>Formally, given <span class="math inline">\(w \in \texttt{week}\)</span> and <span class="math inline">\(c \in \texttt{country}\)</span>, we have <span class="math display">\[\texttt{articles.model}(w,c) \quad = \quad \frac{\texttt{articles}(.,c) \; \texttt{articles}(w,.)}{\texttt{articles}(w,c)} \text{,}\]</span> where <span class="math inline">\(\texttt{articles}(w,.)\)</span> denotes the marginal total along dimension <code>week</code> and <span class="math inline">\(\texttt{articles}(.,.)\)</span> denotes the grand total. It results a normalisation model that both takes into account the average “media coverage” of each country and the global temporal variations.</p>
<p>First, the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country), <span class="kw">articles</span> (week) <span class="op">*</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.model, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model &#39;articles (week * country) ~ articles (week) * articles (country)&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Second, the deviation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geomedia_<span class="dv">2014</span> <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.model</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country), <span class="kw">articles</span> (week) <span class="op">*</span><span class="st"> </span><span class="kw">articles</span> (country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">compute.var.deviation</span> (<span class="kw">articles</span> (week <span class="op">*</span><span class="st"> </span>country)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter.elm</span> (country, name <span class="op">%in%</span><span class="st"> </span>selected_countries) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">plot.var</span> (articles.deviation, <span class="dt">sep.dim.names =</span> country, <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span> (<span class="dt">axis.text.x =</span> <span class="kw">element_text</span> (<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">6</span>))</code></pre></div>
<pre><code>## Computing model &#39;articles (week * country) ~ articles (week) * articles (country)&#39;</code></pre>
<pre><code>## Computing deviation of &#39;articles (week * country)&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>Contrary to the previous deviation plot, we can see here some outliers appearing during the first weeks of 2014, even though the global “media activity” on that period is lower than during the rest of the year.</p>
<p><strong>Warning!</strong> Note that, in the operation sequence above, function <code>compute.var.model</code> (computing the model) is called before function <code>filter.elm</code> (selecting the five countries of interest). Order is important! The normalisation model (and in particular the global “media activity”) is here computed with respect to the full corpus, and not only with respect to the subset of countries. Filtering of elements is here applied after computing the model just to reduce the number of curves to be displayed in the plot.</p>
</div>
<div id="significativity-of-deviations" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Significativity of deviations</h3>
<p>Ratio between observed and expected values induce interpretation errors has it does not account for the statistical significativity of deviations. Indeed, with this basic measure, observing 2 articles when expecting 1 is considered as surprising as observing 200 when expecting 100. Yet, variations on small numbers can be the result of noisy data or randomness in the observed processes.</p>
<p>Function <code>compute.var.deviation</code> hence proposes several measures to account for the significativity of deviations. To this end, argument <code>deviation.type</code> can take the following values:</p>
<ul>
<li><code>ratio</code></li>
</ul>
<p><span class="math display">\[\texttt{var.deviation} \quad = \quad \frac{\texttt{var}}{\texttt{var.model}}\]</span></p>
<ul>
<li><code>chi2</code></li>
</ul>
<p><span class="math display">\[\texttt{var.deviation} \quad = \quad \left\{
  \begin{array}{l}
    \hphantom{-} \displaystyle\frac{(\texttt{var} - \texttt{var.model})^2}{\texttt{var.model}}\\
    \hspace{1em} \text{if } \texttt{var} \geq \texttt{var.model}\\[1ex]
    - \displaystyle\frac{(\texttt{var} - \texttt{var.model})^2}{\texttt{var.model}}\\
    \hspace{1em} \text{if } \texttt{var} \leq \texttt{var.model}
  \end{array}\right.\]</span></p>
<ul>
<li><code>poisson</code></li>
</ul>
<p><span class="math display">\[\texttt{var.deviation} \quad = \quad \left\{
  \begin{array}{l}
    \hphantom{-} \log\Pr (\texttt{var} \geq \text{Pois}(\texttt{var.model}))\\
    \hspace{3em} \text{if } \texttt{var} \geq \texttt{var.model}\\[1ex]
    - \log\Pr (\texttt{var} \leq \text{Pois}(\texttt{var.model}))\\
    \hspace{3em} \text{if } \texttt{var} \leq \texttt{var.model}
  \end{array}\right.\]</span></p>
<ul>
<li><code>KLdiv</code></li>
</ul>
<p><span class="math display">\[\texttt{var.deviation} \quad = \quad \frac{\texttt{var}}{\sum{\texttt{var}}} \; \log_2 \left (\frac{\texttt{var}}{\texttt{var.model}} \right)\]</span></p>
</div>
</div>
<div id="plotting-outliers" class="section level2">
<h2><span class="header-section-number">4.2</span> Plotting Outliers</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multidimensional-exploration.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
